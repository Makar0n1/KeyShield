const { backToMainMenu, helpMenuKeyboard } = require('../keyboards/main');
const { Markup } = require('telegraf');
const messageManager = require('../utils/messageManager');

/**
 * How it works handler
 */
const howItWorks = async (ctx) => {
  try {
    await ctx.answerCbQuery();

    const userId = ctx.from.id;

    const text = `
‚ÑπÔ∏è *–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç KeyShield?*

üîê *–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:*

1Ô∏è‚É£ *–°–æ–∑–¥–∞–Ω–∏–µ —Å–¥–µ–ª–∫–∏*
–ü–æ–∫—É–ø–∞—Ç–µ–ª—å –∏–ª–∏ –ø—Ä–æ–¥–∞–≤–µ—Ü —Å–æ–∑–¥–∞—ë—Ç —Å–¥–µ–ª–∫—É —á–µ—Ä–µ–∑ –±–æ—Ç–∞, —É–∫–∞–∑—ã–≤–∞—è –≤—Å–µ —É—Å–ª–æ–≤–∏—è.

2Ô∏è‚É£ *Multisig-–∫–æ—à–µ–ª—ë–∫*
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∑–∞—â–∏—â—ë–Ω–Ω—ã–π –∫–æ—à–µ–ª—ë–∫ —Å 3 –∫–ª—é—á–∞–º–∏:
‚Ä¢ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å (1 –ø–æ–¥–ø–∏—Å—å)
‚Ä¢ –ü—Ä–æ–¥–∞–≤–µ—Ü (1 –ø–æ–¥–ø–∏—Å—å)
‚Ä¢ –ê—Ä–±–∏—Ç—Ä (1 –ø–æ–¥–ø–∏—Å—å)

–î–ª—è –ª—é–±–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω—É–∂–Ω—ã *2 –∏–∑ 3 –ø–æ–¥–ø–∏—Å–µ–π*.

3Ô∏è‚É£ *–î–µ–ø–æ–∑–∏—Ç*
–ü–æ–∫—É–ø–∞—Ç–µ–ª—å –ø–µ—Ä–µ–≤–æ–¥–∏—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ multisig-–∞–¥—Ä–µ—Å.
–î–µ–Ω—å–≥–∏ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç—Å—è –≤ –±–ª–æ–∫—á–µ–π–Ω–µ, –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç –∏—Ö —É–∫—Ä–∞—Å—Ç—å.

4Ô∏è‚É£ *–†–∞–±–æ—Ç–∞*
–ü—Ä–æ–¥–∞–≤–µ—Ü –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É.

5Ô∏è‚É£ *–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ*
‚Ä¢ *–ë–µ–∑ —Å–ø–æ—Ä–æ–≤:* –ü–æ–∫—É–ø–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç ‚Üí –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç ‚Üí –¥–µ–Ω—å–≥–∏ –ø—Ä–æ–¥–∞–≤—Ü—É
‚Ä¢ *–°–æ —Å–ø–æ—Ä–æ–º:* –ê—Ä–±–∏—Ç—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ ‚Üí –∞—Ä–±–∏—Ç—Ä + –ø–æ–±–µ–¥–∏—Ç–µ–ª—å –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç

‚úÖ *–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:*
‚Ä¢ –ù–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ –æ–¥–∏–Ω–æ—á–∫—É
‚Ä¢ –ü–æ–ª–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≤ –±–ª–æ–∫—á–µ–π–Ω–µ
‚Ä¢ –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ —Å–ø–æ—Ä–æ–≤
‚Ä¢ –ê–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç—å (–±–µ–∑ KYC)

‚ö†Ô∏è *–í–∞–∂–Ω–æ:*
‚Ä¢ –û–±–∞ —É—á–∞—Å—Ç–Ω–∏–∫–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
‚Ä¢ –ú–æ–∂–Ω–æ –∏–º–µ—Ç—å —Ç–æ–ª—å–∫–æ 1 –∞–∫—Ç–∏–≤–Ω—É—é —Å–¥–µ–ª–∫—É
‚Ä¢ –ü—Ä–æ–∏–≥—Ä—ã—à 3 —Å–ø–æ—Ä–æ–≤ –ø–æ–¥—Ä—è–¥ = –∞–≤—Ç–æ–±–∞–Ω
    `.trim();

    // Track navigation
    messageManager.navigateTo(userId, 'how_it_works');

    await messageManager.sendOrEdit(
      ctx,
      userId,
      text,
      Markup.inlineKeyboard([
        [Markup.button.callback('‚¨ÖÔ∏è –ù–∞–∑–∞–¥', 'help')],
        [Markup.button.callback('üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'main_menu')]
      ])
    );
  } catch (error) {
    console.error('Error in how it works:', error);
  }
};

/**
 * Rules and fees handler
 */
const rulesAndFees = async (ctx) => {
  try {
    await ctx.answerCbQuery();

    const userId = ctx.from.id;

    const text = `
üí∞ *–ü—Ä–∞–≤–∏–ª–∞ –∏ –∫–æ–º–∏—Å—Å–∏–∏*

üíµ *–ö–æ–º–∏—Å—Å–∏—è —Å–µ—Ä–≤–∏—Å–∞:*
‚Ä¢ –ú–µ–Ω–µ–µ 300 USDT: —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è *15 USDT*
‚Ä¢ –û—Ç 300 USDT: *5%* –æ—Ç —Å—É–º–º—ã —Å–¥–µ–ª–∫–∏

*–ü–æ—á–µ–º—É 15 USDT –º–∏–Ω–∏–º—É–º?*
–ö–∞–∂–¥–∞—è —Å–¥–µ–ª–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤:
‚Ä¢ –ê–∫—Ç–∏–≤–∞—Ü–∏—è multisig-–∫–æ—à–µ–ª—å–∫–∞: ~15 TRX (~$4)
‚Ä¢ –ö–æ–º–∏—Å—Å–∏–∏ –∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ TRON: ~2-3 USDT
‚Ä¢ –ö–æ–º–∏—Å—Å–∏—è –∑–∞ –ø–µ—Ä–µ–≤–æ–¥: ~1 USDT
‚Ä¢ *–ò—Ç–æ–≥–æ:* ~$8-10 –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤
‚Ä¢ *–ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å —Å–µ—Ä–≤–∏—Å–∞:* –≤—Å–µ–≥–æ $5-7 —Å –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–∏

–ú—ã –Ω–µ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —Å–¥–µ–ª–∫–∞—Ö, –Ω–æ –æ–Ω–∏ –≤–∞–∂–Ω—ã –¥–ª—è –¥–æ–≤–µ—Ä–∏—è!

*–ö—Ç–æ –ø–ª–∞—Ç–∏—Ç –∫–æ–º–∏—Å—Å–∏—é?*
–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–¥–µ–ª–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è:
‚Ä¢ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å –ø–ª–∞—Ç–∏—Ç –≤—Å—é –∫–æ–º–∏—Å—Å–∏—é
‚Ä¢ –ü—Ä–æ–¥–∞–≤–µ—Ü –ø–ª–∞—Ç–∏—Ç –≤—Å—é –∫–æ–º–∏—Å—Å–∏—é
‚Ä¢ 50/50 (–∫–∞–∂–¥—ã–π –ø–æ –ø–æ–ª–æ–≤–∏–Ω–µ)

üìã *–ü—Ä–∞–≤–∏–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:*

1Ô∏è‚É£ *–û–¥–∏–Ω –∞–∫—Ç–∏–≤–Ω—ã–π deal*
–£ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞—è —Å–¥–µ–ª–∫–∞. –ó–∞–≤–µ—Ä—à–∏—Ç–µ —Ç–µ–∫—É—â—É—é –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π.

2Ô∏è‚É£ *–û–±–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –±–æ—Ç–µ*
–ù–µ–ª—å–∑—è —Å–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, –∫–æ—Ç–æ—Ä—ã–π –µ—â—ë –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞.

3Ô∏è‚É£ *–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞*
50 USDT

4Ô∏è‚É£ *–°–ø–æ—Ä—ã*
‚Ä¢ –õ—é–±–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å —Å–ø–æ—Ä
‚Ä¢ –ê—Ä–±–∏—Ç—Ä –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
‚Ä¢ –†–µ—à–µ–Ω–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ

‚ö†Ô∏è *–°–∏—Å—Ç–µ–º–∞ –±–∞–Ω–æ–≤:*
‚Ä¢ 3 –ø—Ä–æ–∏–≥—Ä—ã—à–∞ –ø–æ–¥—Ä—è–¥ = –∞–≤—Ç–æ–±–∞–Ω
‚Ä¢ –í—ã–∏–≥—Ä—ã—à 1 —Å–ø–æ—Ä–∞ = —Å—á—ë—Ç—á–∏–∫ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è
‚Ä¢ –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –∑–∞–±–∞–Ω–∏—Ç—å –≤—Ä—É—á–Ω—É—é –∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏—è

üö´ *–ó–∞–±–∞–Ω–µ–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:*
‚Ä¢ –ù–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–¥–µ–ª–∫–∏
‚Ä¢ –ù–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º
‚Ä¢ –¢–µ–∫—É—â–∏–µ —Å–¥–µ–ª–∫–∏ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è

üìû *–ü–æ–¥–¥–µ—Ä–∂–∫–∞:*
–ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º: @YourSupportUsername
    `.trim();

    // Track navigation
    messageManager.navigateTo(userId, 'rules');

    await messageManager.sendOrEdit(
      ctx,
      userId,
      text,
      Markup.inlineKeyboard([
        [Markup.button.callback('‚¨ÖÔ∏è –ù–∞–∑–∞–¥', 'help')],
        [Markup.button.callback('üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'main_menu')]
      ])
    );
  } catch (error) {
    console.error('Error in rules and fees:', error);
  }
};

/**
 * Support handler
 */
const support = async (ctx) => {
  try {
    await ctx.answerCbQuery();

    const userId = ctx.from.id;

    const text = `
üÜò *–ü–æ–¥–¥–µ—Ä–∂–∫–∞*

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –∏–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:

üìß Email: support@keyshield.io
üí¨ Telegram: @YourSupportUsername

‚è∞ –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: –æ–±—ã—á–Ω–æ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤

*–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã:*

‚ùì *–ö–∞–∫ –¥–æ–ª–≥–æ –∂–¥–∞—Ç—å –¥–µ–ø–æ–∑–∏—Ç?*
–û–±—ã—á–Ω–æ 1-3 –º–∏–Ω—É—Ç—ã –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤ –±–ª–æ–∫—á–µ–π–Ω–µ TRON.

‚ùì *–ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å —Å–¥–µ–ª–∫—É?*
–î–∞, –¥–æ –≤–Ω–µ—Å–µ–Ω–∏—è –¥–µ–ø–æ–∑–∏—Ç–∞.

‚ùì *–°–∫–æ–ª—å–∫–æ –¥–ª–∏—Ç—Å—è –∞—Ä–±–∏—Ç—Ä–∞–∂?*
–û–±—ã—á–Ω–æ 1-3 –¥–Ω—è.

‚ùì *–ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —ç—Ç–æ?*
–î–∞. –ú—É–ª—å—Ç–∏–ø–æ–¥–ø–∏—Å—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞ –≤ –æ–¥–∏–Ω–æ—á–∫—É, –≤–∫–ª—é—á–∞—è —Å–µ—Ä–≤–∏—Å.
    `.trim();

    // Track navigation
    messageManager.navigateTo(userId, 'support');

    await messageManager.sendOrEdit(
      ctx,
      userId,
      text,
      Markup.inlineKeyboard([
        [Markup.button.callback('‚¨ÖÔ∏è –ù–∞–∑–∞–¥', 'help')],
        [Markup.button.callback('üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é', 'main_menu')]
      ])
    );
  } catch (error) {
    console.error('Error in support:', error);
  }
};

module.exports = {
  howItWorks,
  rulesAndFees,
  support
};
